# SPDX-License-Identifier: MIT
#
# MCUboot bootloader configuration for MADI nRF52840
#
# Pass on build:
#   -DEXTRA_CONF_FILE=$(pwd)/ports/zephyr/mcuboot.conf
#   "-DCONFIG_BOOT_SIGNATURE_KEY_FILE=$(pwd)/secrets/dfu_signing_dev.key"

# Signature algorithm: ECDSA P-256 (fast on Cortex-M4, compact footprint)
CONFIG_BOOT_SIGNATURE_TYPE_ECDSA_P256=y

# Swap algorithm: move-based (OTA + rollback, no scratch sector needed)
CONFIG_BOOT_SWAP_USING_MOVE=y

# Validate slot0 image on every boot; rollback to slot1 if invalid
CONFIG_BOOT_VALIDATE_SLOT0=y

# External QSPI NOR flash (MX25R1635F) as secondary slot (slot1)
CONFIG_NORDIC_QSPI_NOR=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_NORDIC_QSPI_NOR_FLASH_LAYOUT_PAGE_SIZE=4096

# Max sectors per image slot: 976 KiB / 4 KiB sector = 244 â†’ round to 256
CONFIG_BOOT_MAX_IMG_SECTORS=256
